import json
import pandas
import csv
from pandas.io.json import json_normalize
import csv, json, sys
#import json-to-csv

data = [{'JobStatus': 'SUCCEEDED', 'VideoMetadata': {'Codec': 'h264', 'DurationMillis': 3304, 'Format': 'QuickTime / MOV', 'FrameRate': 29.970029830932617, 'FrameHeight': 720, 'FrameWidth': 1280}, 'NextToken': 'ppfHZAlS11pQRC5bFT4WaEepVYzbLB65IkvG4DoSgB+ZQyAqH+EvK3ucllYfQow+fuu6k3dsag==', 'Faces': [{'Timestamp': 0, 'Face': {'BoundingBox': {'Width': 0.3304687440395355, 'Height': 0.5861111283302307, 'Left': 0.33671873807907104, 'Top': 0.18611110746860504}, 'Landmarks': [{'Type': 'eyeLeft', 'X': 0.4479547441005707, 'Y': 0.4093329906463623}, {'Type': 'eyeRight', 'X': 0.563101589679718, 'Y': 0.4184841513633728}, {'Type': 'nose', 'X': 0.49900999665260315, 'Y': 0.5067717432975769}, {'Type': 'mouthLeft', 'X': 0.4506451189517975, 'Y': 0.6146191358566284}, {'Type': 'mouthRight', 'X': 0.5387097001075745, 'Y': 0.623519241809845}], 'Pose': {'Roll': 2.248120069503784, 'Yaw': -0.7795935869216919, 'Pitch': 8.918959617614746}, 'Quality': {'Brightness': 88.27379608154297, 'Sharpness': 95.54405975341797}, 'Confidence': 99.99956512451172}}, {'Timestamp': 166, 'Face': {'BoundingBox': {'Width': 0.34062498807907104, 'Height': 0.6069444417953491, 'Left': 0.33125001192092896, 'Top': 0.1527777761220932}, 'Landmarks': [{'Type': 'eyeLeft', 'X': 0.4471014142036438, 'Y': 0.4004663825035095}, {'Type': 'eyeRight', 'X': 0.5630565285682678, 'Y': 0.40960875153541565}, {'Type': 'nose', 'X': 0.49921131134033203, 'Y': 0.5045226812362671}, {'Type': 'mouthLeft', 'X': 0.4481828212738037, 'Y': 0.6107810735702515}, {'Type': 'mouthRight', 'X': 0.5414518713951111, 'Y': 0.6211271286010742}], 'Pose': {'Roll': 2.207913875579834, 'Yaw': -0.09390567988157272, 'Pitch': 7.397311210632324}, 'Quality': {'Brightness': 91.4115982055664, 'Sharpness': 95.54405975341797}, 'Confidence': 99.99935913085938}}, {'Timestamp': 367, 'Face': {'BoundingBox': {'Width': 0.34296876192092896, 'Height': 0.6097221970558167, 'Left': 0.32890623807907104, 'Top': 0.15694443881511688}, 'Landmarks': [{'Type': 'eyeLeft', 'X': 0.44534048438072205, 'Y': 0.4031570553779602}, {'Type': 'eyeRight', 'X': 0.5600844025611877, 'Y': 0.41129443049430847}, {'Type': 'nose', 'X': 0.495650053024292, 'Y': 0.514159619808197}, {'Type': 'mouthLeft', 'X': 0.4468843936920166, 'Y': 0.6154738664627075}, {'Type': 'mouthRight', 'X': 0.5363234877586365, 'Y': 0.625229001045227}], 'Pose': {'Roll': 2.050020456314087, 'Yaw': -1.5846359729766846, 'Pitch': 6.476912021636963}, 'Quality': {'Brightness': 91.44239807128906, 'Sharpness': 94.1185531616211}, 'Confidence': 99.99970245361328}}, {'Timestamp': 567, 'Face': {'BoundingBox': {'Width': 0.34765625, 'Height': 0.6194444298744202, 'Left': 0.3218750059604645, 'Top': 0.1527777761220932}, 'Landmarks': [{'Type': 'eyeLeft', 'X': 0.44283637404441833, 'Y': 0.4046679139137268}, {'Type': 'eyeRight', 'X': 0.5587294101715088, 'Y': 0.41314297914505005}, {'Type': 'nose', 'X': 0.49366483092308044, 'Y': 0.5136210918426514}, {'Type': 'mouthLeft', 'X': 0.4448646903038025, 'Y': 0.6195536851882935}, {'Type': 'mouthRight', 'X': 0.5338093042373657, 'Y': 0.6282079219818115}], 'Pose': {'Roll': 2.1278696060180664, 'Yaw': -1.8469617366790771, 'Pitch': 6.033471584320068}, 'Quality': {'Brightness': 92.30935668945312, 'Sharpness': 95.54405975341797}, 'Confidence': 99.99862670898438}}, {'Timestamp': 767, 'Face': {'BoundingBox': {'Width': 0.3453125059604645, 'Height': 0.6138888597488403, 'Left': 0.32421875, 'Top': 0.15694443881511688}, 'Landmarks': [{'Type': 'eyeLeft', 'X': 0.444472074508667, 'Y': 0.40875452756881714}, {'Type': 'eyeRight', 'X': 0.5567071437835693, 'Y': 0.4142427146434784}, {'Type': 'nose', 'X': 0.49262699484825134, 'Y': 0.5173217058181763}, {'Type': 'mouthLeft', 'X': 0.44411811232566833, 'Y': 0.6255146265029907}, {'Type': 'mouthRight', 'X': 0.5372706651687622, 'Y': 0.6317689418792725}], 'Pose': {'Roll': 1.3321635723114014, 'Yaw': -2.6102802753448486, 'Pitch': 7.540515422821045}, 'Quality': {'Brightness': 91.8366470336914, 'Sharpness': 94.1185531616211}, 'Confidence': 99.9999771118164}}, {'Timestamp': 967, 'Face': {'BoundingBox': {'Width': 0.34687501192092896, 'Height': 0.6166666746139526, 'Left': 0.3218750059604645, 'Top': 0.16111111640930176}, 'Landmarks': [{'Type': 'eyeLeft', 'X': 0.44039082527160645, 'Y': 0.403963565826416}, {'Type': 'eyeRight', 'X': 0.5561920404434204, 'Y': 0.4063866138458252}, {'Type': 'nose', 'X': 0.49135249853134155, 'Y': 0.5113712549209595}, {'Type': 'mouthLeft', 'X': 0.44626492261886597, 'Y': 0.6245241165161133}, {'Type': 'mouthRight', 'X': 0.5361146926879883, 'Y': 0.6305819153785706}], 'Pose': {'Roll': 0.39799752831459045, 'Yaw': -2.2034339904785156, 'Pitch': 9.205512046813965}, 'Quality': {'Brightness': 92.08476257324219, 'Sharpness': 96.63640594482422}, 'Confidence': 99.99999237060547}}, {'Timestamp': 1167, 'Face': {'BoundingBox': {'Width': 0.34062498807907104, 'Height': 0.605555534362793, 'Left': 0.3257812559604645, 'Top': 0.15694443881511688}, 'Landmarks': [{'Type': 'eyeLeft', 'X': 0.4443298280239105, 'Y': 0.41054627299308777}, {'Type': 'eyeRight', 'X': 0.555994987487793, 'Y': 0.41349369287490845}, {'Type': 'nose', 'X': 0.49319571256637573, 'Y': 0.5075596570968628}, {'Type': 'mouthLeft', 'X': 0.44561800360679626, 'Y': 0.6179233193397522}, {'Type': 'mouthRight', 'X': 0.5373557209968567, 'Y': 0.6247365474700928}], 'Pose': {'Roll': 0.5979605913162231, 'Yaw': -2.724250078201294, 'Pitch': 8.913064002990723}, 'Quality': {'Brightness': 91.25988006591797, 'Sharpness': 94.1185531616211}, 'Confidence': 99.99934387207031}}, {'Timestamp': 1368, 'Face': {'BoundingBox': {'Width': 0.34843748807907104, 'Height': 0.6194444298744202, 'Left': 0.3218750059604645, 'Top': 0.15416666865348816}, 'Landmarks': [{'Type': 'eyeLeft', 'X': 0.43995586037635803, 'Y': 0.4019007384777069}, {'Type': 'eyeRight', 'X': 0.5566719770431519, 'Y': 0.4005553424358368}, {'Type': 'nose', 'X': 0.4893549978733063, 'Y': 0.5037533044815063}, {'Type': 'mouthLeft', 'X': 0.4472108781337738, 'Y': 0.6231054663658142}, {'Type': 'mouthRight', 'X': 0.5361253619194031, 'Y': 0.6273581981658936}], 'Pose': {'Roll': -0.5293210744857788, 'Yaw': -4.551120281219482, 'Pitch': 10.178024291992188}, 'Quality': {'Brightness': 92.35647583007812, 'Sharpness': 95.54405975341797}, 'Confidence': 99.99537658691406}}, {'Timestamp': 1568, 'Face': {'BoundingBox': {'Width': 0.34687501192092896, 'Height': 0.6166666746139526, 'Left': 0.3203125, 'Top': 0.15833333134651184}, 'Landmarks': [{'Type': 'eyeLeft', 'X': 0.43570199608802795, 'Y': 0.4032064974308014}, {'Type': 'eyeRight', 'X': 0.5522316098213196, 'Y': 0.39923104643821716}, {'Type': 'nose', 'X': 0.484272301197052, 'Y': 0.5041149854660034}, {'Type': 'mouthLeft', 'X': 0.44156593084335327, 'Y': 0.6206300258636475}, {'Type': 'mouthRight', 'X': 0.5329512357711792, 'Y': 0.6222752332687378}], 'Pose': {'Roll': -1.1305396556854248, 'Yaw': -6.211359977722168, 'Pitch': 10.311464309692383}, 'Quality': {'Brightness': 92.18507385253906, 'Sharpness': 94.1185531616211}, 'Confidence': 100.0}}, {'Timestamp': 1768, 'Face': {'BoundingBox': {'Width': 0.3414062559604645, 'Height': 0.6083333492279053, 'Left': 0.3140625059604645, 'Top': 0.17222222685813904}, 'Landmarks': [{'Type': 'eyeLeft', 'X': 0.42808952927589417, 'Y': 0.4091871380805969}, {'Type': 'eyeRight', 'X': 0.5406334400177002, 'Y': 0.40314412117004395}, {'Type': 'nose', 'X': 0.4707258343696594, 'Y': 0.5014078617095947}, {'Type': 'mouthLeft', 'X': 0.43530941009521484, 'Y': 0.6210749745368958}, {'Type': 'mouthRight', 'X': 0.5271620750427246, 'Y': 0.6183254718780518}], 'Pose': {'Roll': -1.6499069929122925, 'Yaw': -7.9709882736206055, 'Pitch': 11.585646629333496}, 'Quality': {'Brightness': 90.75560760498047, 'Sharpness': 94.1185531616211}, 'Confidence': 99.9991455078125}}], 'ResponseMetadata': {'RequestId': '692a1e23-e822-11e8-80c6-3560c7a7932d', 'HTTPStatusCode': 200, 'HTTPHeaders': {'content-type': 'application/x-amz-json-1.1', 'date': 'Wed, 14 Nov 2018 15:31:51 GMT', 'x-amzn-requestid': '692a1e23-e822-11e8-80c6-3560c7a7932d', 'content-length': '7085', 'connection': 'keep-alive'}, 'RetryAttempts': 0}}]

def JSON_to_CSV(JSON):
#data2 = json.dumps(data)

#print(data2)

#pandas.read_json(json.dumps(data2)).to_csv('test.csv')

    df = json_normalize(data, 'Faces')
#df = json.loads(data)

    for faceDetection in JSON['Faces']:
        print('Face: ' + str(faceDetection['Face']))

    df.to_csv('test.csv')

    with open('test.csv') as f:
            print(f.read())

